---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/Header.astro';
import JobCard from '../../components/JobCard.astro';
import { getCollection } from 'astro:content';

const jobs = (await getCollection('jobs'))
  .filter(job => job.data.category === 'latest-jobs')
  .sort((a, b) => new Date(b.data.publishedAt).getTime() - new Date(a.data.publishedAt).getTime());

const structuredData = {
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "Latest Government Jobs",
  "description": "Browse latest government job opportunities across India",
  "url": Astro.url.href
};
---

<BaseLayout 
  title="Latest Government Jobs 2025 - Sarkari Naukri"
  description="Find latest government jobs, sarkari naukri opportunities. Apply for central and state government positions. Daily updates on new job notifications."
  structuredData={structuredData}
>
  <Header />
  
  <!-- Minimal Filter Bar -->
  <div class="container mx-auto px-4 mt-8 mb-10">
    <div class="bg-white rounded-xl shadow p-4 flex flex-wrap gap-3 items-center justify-center md:justify-start border border-blue-100">
      <span class="font-semibold text-gray-700 mr-2">Filter:</span>
      <button class="px-4 py-1 rounded-full bg-blue-600 text-white font-semibold shadow hover:bg-blue-700 transition text-sm">All</button>
      <button class="px-4 py-1 rounded-full bg-white border border-blue-200 text-blue-700 font-semibold shadow hover:bg-blue-50 transition text-sm">SSC</button>
      <button class="px-4 py-1 rounded-full bg-white border border-blue-200 text-blue-700 font-semibold shadow hover:bg-blue-50 transition text-sm">Railway</button>
      <button class="px-4 py-1 rounded-full bg-white border border-blue-200 text-blue-700 font-semibold shadow hover:bg-blue-50 transition text-sm">Banking</button>
      <button class="px-4 py-1 rounded-full bg-white border border-blue-200 text-blue-700 font-semibold shadow hover:bg-blue-50 transition text-sm">UPSC</button>
      <!-- Add more pill filters as needed -->
    </div>
  </div>

  <!-- Jobs Grid -->
  <div id="jobs-list" class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
      {jobs.map((job) => (
        <div class="relative group bg-white rounded-3xl shadow-xl border border-blue-100 hover:shadow-2xl transition-shadow duration-200 overflow-hidden">
          {job.data.featured && (
            <span class="absolute top-4 right-4 bg-yellow-400 text-yellow-900 text-xs font-bold px-3 py-1 rounded-full shadow">Featured</span>
          )}
          <JobCard
            title={job.data.title}
            organization={job.data.organization}
            posts={job.data.posts}
            lastDate={job.data.lastDate}
            category={job.data.category}
            featured={job.data.featured}
            slug={job.slug}
          />
          <div class="absolute bottom-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity">
            <a href={`/latest-jobs/${job.slug}`} class="inline-flex items-center bg-blue-600 text-white px-4 py-2 rounded-full font-semibold shadow hover:bg-blue-700 transition">
              View Details
              <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 20 20"><path d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
            </a>
          </div>
        </div>
      ))}
    </div>

    {jobs.length === 0 && (
      <div class="flex flex-col items-center justify-center py-20">
        <img src="https://undraw.co/api/illustrations/undraw_empty_re_opql.svg" alt="No jobs" class="w-64 h-64 mb-6" loading="lazy" />
        <p class="text-gray-500 text-xl font-semibold">No jobs found. Check back later for new opportunities!</p>
      </div>
    )}
  </div>
</BaseLayout>